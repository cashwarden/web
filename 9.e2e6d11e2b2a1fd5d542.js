(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"O+XU":function(t,e,s){"use strict";s.r(e),s.d(e,"RecurrenceModule",(function(){return f}));var i=s("M0ag"),a=s("tyNb"),c=s("xK1T"),n=s("fXoL"),r=s("Ac7g"),u=s("PScX"),o=s("JA5x"),d=s("B+r4"),l=s("ok2U"),h=s("DGaY");const m=["st"],b=function(){return{xs:6,sm:16,md:24,lg:32}},p=[{path:"index",component:(()=>{class t{constructor(t,e,s){this.http=t,this.modal=e,this.message=s,this.loading=!0,this.list=[],this.q={page:1,name:""},this.url="/api/recurrences",this.searchSchema={properties:{name:{type:"string",title:"\u540d\u79f0"}}},this.columns=[{title:"\u540d\u79f0 ",index:"name"},{title:"\u9891\u7387",index:"frequency_text"},{title:"\u65f6\u95f4\u503c",index:"schedule"},{title:"\u5f00\u59cb\u65f6\u95f4",type:"date",index:"started_at",dateFormat:"yyyy-MM-dd"},{title:"\u4e0b\u6b21\u6267\u884c\u65f6\u95f4",type:"date",index:"execution_date",dateFormat:"yyyy-MM-dd"},{title:"\u72b6\u6001",type:"badge",index:"status",badge:{active:{text:"active",color:"success"},unactivated:{text:"unactivated",color:"default"}}},{title:"\u66f4\u65b0\u65f6\u95f4",type:"date",index:"updated_at"},{title:"",buttons:[{text:"\u7f16\u8f91",click:t=>this.form(t)},{text:t=>"active"===t.status?"\u505c\u7528":"\u542f\u7528",click:t=>{this.updateStatus(t,"active"===t.status?"unactivated":"active")}},{text:"\u5220\u9664",pop:{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",okType:"danger"},click:(t,e,s)=>{this.delete(t),s.removeRow(t)}}]}]}ngOnInit(){this.getData()}getData(){this.loading=!0,this.http.get(this.url,this.q).subscribe(t=>{this.list=t.data.items,this.loading=!1})}form(t={}){this.modal.create(c.a,{record:t},{size:"md"}).subscribe(t=>{this.getData()})}copy(t){this.http.post(`${this.url}/${t.id}/copy`).subscribe(t=>{0===(null==t?void 0:t.code)?(this.list.splice(0,0,t.data),this.list=[...this.list],this.message.success("\u590d\u5236\u6210\u529f")):this.message.warning(null==t?void 0:t.message)})}delete(t){this.http.delete(`${this.url}/${t.id}`).subscribe(t=>{0===(null==t?void 0:t.code)?this.message.success("\u5220\u9664\u6210\u529f"):this.message.warning(null==t?void 0:t.message)})}updateStatus(t,e){this.http.put(`${this.url}/${t.id}/status`,{status:e}).subscribe(t=>{0===(null==t?void 0:t.code)?(this.getData(),this.message.success("\u66f4\u65b0\u6210\u529f")):this.message.warning(null==t?void 0:t.message)})}submit(t){this.q.name=t.name,this.getData()}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(r.r),n.Ob(r.j),n.Ob(u.e))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-recurrence-index"]],viewQuery:function(t,e){var s;1&t&&n.Pc(m,!0),2&t&&n.uc(s=n.cc())&&(e.st=s.first)},decls:8,vars:5,consts:[[1,"pt-lg"],["nz-row","",3,"nzGutter"],["nz-col",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","columns"],["st",""]],template:function(t,e){if(1&t){const t=n.Vb();n.Ub(0,"div",0),n.Ub(1,"nz-card"),n.Ub(2,"div",1),n.Ub(3,"div",2),n.Ub(4,"sf",3),n.bc("formSubmit",(function(t){return e.submit(t)}))("formReset",(function(e){return n.yc(t),n.vc(7).reset(e)})),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Ub(5,"nz-card"),n.Pb(6,"st",4,5),n.Tb()}2&t&&(n.Ab(2),n.mc("nzGutter",n.pc(4,b)),n.Ab(2),n.mc("schema",e.searchSchema),n.Ab(2),n.mc("data",e.list)("columns",e.columns))},directives:[o.a,d.c,d.a,l.b,h.a],encapsulation:2}),t})()}];let g=(()=>{class t{}return t.\u0275mod=n.Mb({type:t}),t.\u0275inj=n.Lb({factory:function(e){return new(e||t)},imports:[[a.n.forChild(p)],a.n]}),t})(),f=(()=>{class t{}return t.\u0275mod=n.Mb({type:t}),t.\u0275inj=n.Lb({factory:function(e){return new(e||t)},imports:[[i.b,g]]}),t})()}}]);