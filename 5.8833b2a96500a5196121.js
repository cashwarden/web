(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{rSnh:function(n,e,t){"use strict";t.r(e),t.d(e,"AccountModule",(function(){return X}));var c=t("M0ag"),o=t("tyNb"),i=t("fXoL"),a=t("Ac7g"),b=t("dEAy"),r=t("PScX"),l=t("3Pt+"),s=t("ocnv"),u=t("O3k0"),d=t("PTRe"),m=t("zAKX"),g=t("ofXK"),p=t("bE2y"),f=t("EGpF"),z=t("OzZK"),h=t("RwU8"),T=t("C2AL"),v=t("FwiY");function y(n,e){if(1&n&&(i.Ub(0,"nz-option",24),i.Pb(1,"i",25),i.Kc(2),i.Tb()),2&n){const n=e.$implicit;i.mc("nzLabel",n.name)("nzValue",n.type),i.Ab(1),i.oc("nzIconfont","icon-",n.type,""),i.Ab(1),i.Mc(" ",n.name," ")}}function U(n,e){if(1&n){const n=i.Vb();i.Ub(0,"nz-select",26),i.bc("ngModelChange",(function(e){return i.yc(n),i.ec().form.currency_code=e})),i.Pb(1,"nz-option",27),i.Tb()}if(2&n){const n=i.ec();i.mc("ngModel",n.form.currency_code)}}let A=(()=>{class n{constructor(n,e,t){this.http=n,this.modal=e,this.msgSrv=t,this.record={},this.form={name:"",type:"general_account",currency_balance:"",currency_code:"CNY",status:"active",default:!1,exclude_from_stats:!1}}ngOnInit(){this.record.id&&(this.form=this.record)}save(n){this.http.request(this.record.id?"put":"post","/api/accounts"+(this.record.id?"/"+this.record.id:""),{body:n}).subscribe(n=>{0===n.code?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(n.data)):this.msgSrv.warning(n.message)})}close(){this.modal.destroy()}}return n.\u0275fac=function(e){return new(e||n)(i.Ob(a.r),i.Ob(b.b),i.Ob(r.e))},n.\u0275cmp=i.Ib({type:n,selectors:[["app-account-form"]],decls:32,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["nz-form","","se-container","1","labelWidth","100",3,"ngSubmit"],["f","ngForm"],["label","\u540d\u79f0"],["type","text","nz-input","","name","name","required","",3,"ngModel","ngModelChange"],["label","\u7c7b\u578b"],["name","type","required","",3,"ngModel","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["label","\u4f59\u989d"],[3,"nzAddOnAfter"],["nz-input","","type","number","name","currency_balance","required","",3,"ngModel","ngModelChange"],["addOnAfterBtn",""],["label","\u72b6\u6001"],["nzButtonStyle","solid","name","status",3,"ngModel","ngModelChange"],["nz-radio-button","","nzValue","active"],["nz-radio-button","","nzValue","unactivated"],["label","\u9ed8\u8ba4\u8d26\u53f7","col","1"],["name","default",3,"ngModel","ngModelChange"],["label","\u4e0d\u8ba1\u5165\u7edf\u8ba1","col","1"],["name","exclude_from_stats",3,"ngModel","ngModelChange"],["col","1"],["nz-button","","type","button",3,"click"],["nz-button","","nzType","primary",3,"disabled"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","",3,"nzIconfont"],["name","currency_code",2,"width","80px",3,"ngModel","ngModelChange"],["nzLabel","CNY","nzValue","CNY"]],template:function(n,e){if(1&n&&(i.Ub(0,"div",0),i.Ub(1,"div",1),i.Kc(2,"\u8d26\u6237\u7f16\u8f91"),i.Tb(),i.Tb(),i.Ub(3,"form",2,3),i.bc("ngSubmit",(function(){return e.save(e.form)})),i.Ub(5,"se",4),i.Ub(6,"input",5),i.bc("ngModelChange",(function(n){return e.form.name=n})),i.Tb(),i.Tb(),i.Ub(7,"se",6),i.Ub(8,"nz-select",7),i.bc("ngModelChange",(function(n){return e.form.type=n})),i.Ic(9,y,3,4,"nz-option",8),i.Tb(),i.Tb(),i.Ub(10,"se",9),i.Ub(11,"nz-input-group",10),i.Ub(12,"input",11),i.bc("ngModelChange",(function(n){return e.form.currency_balance=n})),i.Tb(),i.Ic(13,U,2,1,"ng-template",null,12,i.Jc),i.Tb(),i.Tb(),i.Ub(15,"se",13),i.Ub(16,"nz-radio-group",14),i.bc("ngModelChange",(function(n){return e.form.status=n})),i.Ub(17,"label",15),i.Ub(18,"span"),i.Kc(19,"\u542f\u7528"),i.Tb(),i.Tb(),i.Ub(20,"label",16),i.Ub(21,"span"),i.Kc(22,"\u51bb\u7ed3"),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Ub(23,"se",17),i.Ub(24,"nz-switch",18),i.bc("ngModelChange",(function(n){return e.form.default=n})),i.Tb(),i.Tb(),i.Ub(25,"se",19),i.Ub(26,"nz-switch",20),i.bc("ngModelChange",(function(n){return e.form.exclude_from_stats=n})),i.Tb(),i.Tb(),i.Ub(27,"se",21),i.Ub(28,"button",22),i.bc("click",(function(){return e.close()})),i.Kc(29,"\u5173\u95ed"),i.Tb(),i.Ub(30,"button",23),i.Kc(31,"\u4fdd\u5b58"),i.Tb(),i.Tb(),i.Tb()),2&n){const n=i.vc(4),t=i.vc(14);i.Ab(6),i.mc("ngModel",e.form.name),i.Ab(2),i.mc("ngModel",e.form.type),i.Ab(1),i.mc("ngForOf",e.accountTypes),i.Ab(2),i.mc("nzAddOnAfter",t),i.Ab(1),i.mc("ngModel",e.form.currency_balance),i.Ab(4),i.mc("ngModel",e.form.status),i.Ab(8),i.mc("ngModel",e.form.default),i.Ab(2),i.mc("ngModel",e.form.exclude_from_stats),i.Ab(4),i.mc("disabled",n.invalid)}},directives:[l.t,l.m,l.n,s.b,u.b,u.a,d.b,l.c,l.r,l.l,l.o,m.e,g.m,d.c,l.p,p.c,p.b,p.a,f.a,z.a,h.a,T.a,m.a,v.a],encapsulation:2}),n})();var M=t("JA5x"),C=t("B+r4"),w=t("Ff2k"),O=t("ngc+"),I=t("KupA"),K=t("ZyQt");function S(n,e){if(1&n&&(i.Ub(0,"nz-option",19),i.Pb(1,"i",20),i.Kc(2),i.Tb()),2&n){const n=e.$implicit;i.mc("nzLabel",n.name)("nzValue",n.type),i.Ab(1),i.oc("nzIconfont","icon-",n.type,""),i.Ab(1),i.Mc(" ",n.name," ")}}function L(n,e){if(1&n&&i.Pb(0,"nz-option",21),2&n){const n=e.$implicit;i.mc("nzLabel",n.label)("nzValue",n.value)}}function _(n,e){if(1&n){const n=i.Vb();i.Ub(0,"p",27),i.bc("click",(function(){i.yc(n);const e=i.ec().$implicit;return i.ec().form(e)})),i.Kc(1),i.Tb()}if(2&n){const n=i.ec().$implicit;i.Ab(1),i.Lc(n.name)}}function k(n,e){if(1&n){const n=i.Vb();i.Ub(0,"i",28),i.bc("click",(function(){i.yc(n);const e=i.ec().$implicit;return i.ec().form(e)})),i.Tb()}if(2&n){const n=i.ec().$implicit;i.oc("nzIconfont","icon-",n.type,"")}}function P(n,e){if(1&n){const n=i.Vb();i.Ub(0,"span",29),i.Ub(1,"i",30),i.bc("click",(function(){i.yc(n);const e=i.ec().$implicit;return i.ec().form(e)})),i.Tb(),i.Tb(),i.Ub(2,"span",29),i.Ub(3,"i",31),i.bc("nzOnConfirm",(function(){i.yc(n);const e=i.ec().$implicit;return i.ec().delete(e)})),i.Tb(),i.Tb()}}function q(n,e){1&n&&(i.Ub(0,"nz-tag"),i.Kc(1,"\u9ed8\u8ba4\u8d26\u6237"),i.Tb())}function V(n,e){1&n&&(i.Ub(0,"nz-tag"),i.Kc(1,"\u51bb\u7ed3"),i.Tb())}function F(n,e){if(1&n&&(i.Ub(0,"nz-tag"),i.Kc(1),i.Tb(),i.Ic(2,q,2,0,"nz-tag",32),i.Ic(3,V,2,0,"nz-tag",32)),2&n){const n=i.ec().$implicit;i.Ab(1),i.Lc(n.type_name),i.Ab(1),i.mc("ngIf",n.default),i.Ab(1),i.mc("ngIf","unactivated"==n.status)}}function x(n,e){if(1&n&&(i.Ub(0,"g2-card",22),i.fc(1,"_currency"),i.Ic(2,_,2,1,"ng-template",null,23,i.Jc),i.Ic(4,k,1,1,"ng-template",null,24,i.Jc),i.Ic(6,P,4,0,"ng-template",null,25,i.Jc),i.Ic(8,F,4,3,"ng-template",null,26,i.Jc),i.Tb()),2&n){const n=e.$implicit,t=i.vc(3),c=i.vc(5),o=i.vc(7),a=i.vc(9);i.mc("title",t)("bordered",!0)("total",i.gc(1,6,n.balance))("footer",a)("avatar",c)("action",o)}}const $=function(){return{gutter:24,lg:8,md:12,sm:24,xs:24}},D=[{path:"index",component:(()=>{class n{constructor(n,e,t,c,o){this.http=n,this.msg=e,this.modal=t,this.cdr=c,this.router=o,this.q={page:1,pageSize:50},this.accountSorts=[{value:"-balance_cent",label:"\u4f59\u989d\u5012\u5e8f"},{value:"balance_cent",label:"\u4f59\u989d\u6b63\u5e8f"}],this.accountTypes=[],this.list=[],this.loading=!0}ngOnInit(){this.getOverview(),this.getData(),this.getAccountTypes()}getData(){this.loading=!0;const n={};Object.entries(this.q).filter(([,n])=>null!==n).map(([e,t])=>n[e]=t),this.q=n,this.http.get("/api/accounts",this.q).subscribe(n=>{this.list=n.data.items,this.loading=!1,this.cdr.detectChanges()})}getAccountTypes(){this.http.get("/api/accounts/types").subscribe(n=>{0===n.code?n.data&&(this.accountTypes=n.data,this.cdr.detectChanges()):this.msg.warning(n.message)})}getOverview(){this.http.get("/api/accounts/overview").subscribe(n=>{this.overview=n.data,this.cdr.detectChanges()})}search(){this.getData()}reset(){this.q={page:1,pageSize:50},this.getData()}to(n){this.router.navigateByUrl("/account/view/"+n.key)}form(n={}){this.modal.create(A,{record:n,accountTypes:this.accountTypes},{size:"md"}).subscribe(n=>{this.getData(),this.getOverview(),this.cdr.detectChanges()})}delete(n){this.http.delete("/api/accounts/"+n.id).subscribe(n=>{0===(null==n?void 0:n.code)?(this.getData(),this.getOverview(),this.msg.success("\u5220\u9664\u6210\u529f")):this.msg.warning(null==n?void 0:n.message)})}}return n.\u0275fac=function(e){return new(e||n)(i.Ob(a.r),i.Ob(r.e),i.Ob(a.j),i.Ob(i.h),i.Ob(o.k))},n.\u0275cmp=i.Ib({type:n,selectors:[["app-account-index"]],decls:47,vars:28,consts:[[1,"pt-lg"],["nz-row",""],["nz-col","",1,"header-info",3,"nzXs","nzSm"],[1,"text-grey-dark"],[1,"d-block","display-2"],["nz-form","","se-container","","size","compact","gutter","24",3,"labelWidth","ngSubmit"],["f","ngForm"],["col","6"],["nz-input","","name","name","placeholder","\u641c\u7d22\u8d26\u6237\u540d\u79f0",3,"ngModel","ngModelChange"],["name","type","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["name","sort","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",3,"click"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus"],[3,"nzDataSource","nzLoading","nzRenderItem","nzGrid"],["item",""],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","",3,"nzIconfont"],[3,"nzLabel","nzValue"],[3,"title","bordered","total","footer","avatar","action"],["title",""],["avatar",""],["action",""],["footer",""],[3,"click"],["nz-icon","",1,"icon-md",3,"nzIconfont","click"],[1,"pl-sm"],["nz-icon","","nzType","edit",3,"click"],["nz-icon","","nzType","delete","nz-popconfirm","","nzPopconfirmTitle","\u786e\u5b9a\u8981\u5220\u9664\u5e10\u6237\u5417\uff1f\u5982\u679c\u5e10\u6237\u88ab\u5220\u9664\uff0c\u6240\u6709\u6d89\u53ca\u7684\u4ea4\u6613\u3001\u89c4\u5219\u548c\u5b9a\u65f6\u914d\u7f6e\u5c06\u6c38\u8fdc\u5931\u53bb\u3002","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],[4,"ngIf"]],template:function(n,e){if(1&n&&(i.Ub(0,"div",0),i.Ub(1,"nz-card"),i.Ub(2,"div",1),i.Ub(3,"div",2),i.Ub(4,"span",3),i.Kc(5,"\u51c0\u8d44\u4ea7"),i.Tb(),i.Ub(6,"span",4),i.Kc(7),i.Tb(),i.Pb(8,"em"),i.Tb(),i.Ub(9,"div",2),i.Ub(10,"span",3),i.Kc(11,"\u8d1f\u503a"),i.Tb(),i.Ub(12,"span",4),i.Kc(13),i.Tb(),i.Pb(14,"em"),i.Tb(),i.Ub(15,"div",2),i.Ub(16,"span",3),i.Kc(17,"\u603b\u8d44\u4ea7"),i.Tb(),i.Ub(18,"span",4),i.Kc(19),i.Tb(),i.Tb(),i.Ub(20,"div",2),i.Ub(21,"span",3),i.Kc(22,"\u8d26\u6237\u6570"),i.Tb(),i.Ub(23,"span",4),i.Kc(24),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Ub(25,"nz-card"),i.Ub(26,"form",5,6),i.bc("ngSubmit",(function(){return e.search()})),i.Ub(28,"se",7),i.Ub(29,"input",8),i.bc("ngModelChange",(function(n){return e.q.name=n})),i.Tb(),i.Tb(),i.Ub(30,"se",7),i.Ub(31,"nz-select",9),i.bc("ngModelChange",(function(n){return e.q.type=n})),i.Ic(32,S,3,4,"nz-option",10),i.Tb(),i.Tb(),i.Ub(33,"se",7),i.Ub(34,"nz-select",11),i.bc("ngModelChange",(function(n){return e.q.sort=n})),i.Ic(35,L,1,2,"nz-option",12),i.Tb(),i.Tb(),i.Ub(36,"button",13),i.Kc(37,"\u67e5\u8be2"),i.Tb(),i.Ub(38,"button",14),i.bc("click",(function(){return e.reset()})),i.Kc(39,"\u91cd\u7f6e"),i.Tb(),i.Tb(),i.Ub(40,"button",15),i.bc("click",(function(){return e.form()})),i.Pb(41,"i",16),i.Ub(42,"span"),i.Kc(43,"\u65b0\u5efa"),i.Tb(),i.Tb(),i.Tb(),i.Ub(44,"nz-list",17),i.Ic(45,x,10,8,"ng-template",null,18,i.Jc),i.Tb()),2&n){const n=i.vc(46);i.Ab(3),i.mc("nzXs",24)("nzSm",6),i.Ab(4),i.Lc(null==e.overview?null:e.overview.net_asset),i.Ab(2),i.mc("nzXs",24)("nzSm",6),i.Ab(4),i.Lc(null==e.overview?null:e.overview.liabilities),i.Ab(2),i.mc("nzXs",24)("nzSm",6),i.Ab(4),i.Lc(null==e.overview?null:e.overview.total_assets),i.Ab(1),i.mc("nzXs",24)("nzSm",6),i.Ab(4),i.Lc(null==e.overview?null:e.overview.count),i.Ab(2),i.mc("labelWidth",null),i.Ab(3),i.mc("ngModel",e.q.name),i.Ab(2),i.mc("ngModel",e.q.type)("nzPlaceHolder","\u5168\u90e8\u7c7b\u578b"),i.Ab(1),i.mc("ngForOf",e.accountTypes),i.Ab(2),i.mc("ngModel",e.q.sort)("nzPlaceHolder","\u9ed8\u8ba4\u6392\u5e8f"),i.Ab(1),i.mc("ngForOf",e.accountSorts),i.Ab(1),i.mc("nzType","primary")("nzLoading",e.loading),i.Ab(4),i.mc("nzType","primary"),i.Ab(4),i.mc("nzDataSource",e.list)("nzLoading",e.loading)("nzRenderItem",n)("nzGrid",i.pc(27,$))}},directives:[M.a,C.c,C.a,l.t,l.m,l.n,s.b,u.b,u.a,d.b,l.c,l.l,l.o,m.e,g.m,z.a,h.a,T.a,v.a,w.a,w.b,m.a,O.a,I.a,K.a,g.n],pipes:[a.c],styles:[""],changeDetection:0}),n})()}];let J=(()=>{class n{}return n.\u0275mod=i.Mb({type:n}),n.\u0275inj=i.Lb({factory:function(e){return new(e||n)},imports:[[o.n.forChild(D)],o.n]}),n})();t("qAZ0"),t("0lRi");let X=(()=>{class n{}return n.\u0275mod=i.Mb({type:n}),n.\u0275inj=i.Lb({factory:function(e){return new(e||n)},imports:[[c.b,J]]}),n})()}}]);