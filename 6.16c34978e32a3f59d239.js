(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{yNfe:function(t,e,a){"use strict";a.r(e),a.d(e,"AnalysisModule",(function(){return _}));var n=a("M0ag"),c=a("tyNb"),i=a("RY2A"),o=a("fXoL"),r=a("Ac7g"),s=a("ofXK"),d=a("9H8w"),b=a("B+r4"),l=a("JA5x"),m=a("J09d"),g=a("oyxB"),u=a("NBwf"),h=a("DGaY"),p=a("rMZv");const f=["st"];function y(t,e){if(1&t&&(o.Pb(0,"g2-pie",12),o.fc(1,"_currency")),2&t){const t=o.ec();o.mc("hasLegend",!0)("total",o.gc(1,4,t.pieData.total.expense))("valueFormat",t.handlePieValueFormat)("data",t.pieData.expense)}}function z(t,e){if(1&t&&(o.Pb(0,"g2-pie",13),o.fc(1,"_currency")),2&t){const t=o.ec();o.mc("hasLegend",!0)("total",o.gc(1,4,t.pieData.total.income))("valueFormat",t.handlePieValueFormat)("data",t.pieData.income)}}function T(t,e){if(1&t&&o.Pb(0,"g2-bar",19),2&t){const t=o.ec().$implicit,e=o.ec(2);o.mc("title","\u652f\u51fa"+t.name)("data",e.recordSumData.expense)}}function D(t,e){if(1&t&&o.Pb(0,"g2-bar",19),2&t){const t=o.ec().$implicit,e=o.ec(2);o.mc("title","\u6536\u5165"+t.name)("data",e.recordSumData.income)}}function x(t,e){if(1&t&&(o.Ub(0,"nz-tab",16),o.Ub(1,"div",17),o.Ic(2,T,1,2,"g2-bar",18),o.Tb(),o.Ub(3,"div",17),o.Ic(4,D,1,2,"g2-bar",18),o.Tb(),o.Tb()),2&t){const t=e.$implicit,a=o.ec(2);o.mc("nzTitle",t.name),o.Ab(2),o.mc("ngIf",t.show&&a.recordSumData.expense.length),o.Ab(2),o.mc("ngIf",t.show&&a.recordSumData.income.length)}}function I(t,e){if(1&t){const t=o.Vb();o.Ub(0,"nz-tabset",14),o.bc("nzSelectedIndexChange",(function(e){return o.yc(t),o.ec().changeTab(e)})),o.Ic(1,x,5,3,"nz-tab",15),o.Tb()}if(2&t){const t=o.ec();o.Ab(1),o.mc("ngForOf",t.tabs)}}function U(t,e){if(1&t&&(o.Ub(0,"tr"),o.Ub(1,"td"),o.Ub(2,"strong"),o.Kc(3,"\u7ed3\u4f59"),o.Tb(),o.Tb(),o.Ub(4,"td",23),o.Ub(5,"strong"),o.Kc(6),o.fc(7,"_currency"),o.Tb(),o.Tb(),o.Tb()),2&t){const t=o.ec(3);o.Ab(6),o.Lc(o.gc(7,1,t.data.total.surplus))}}function v(t,e){if(1&t&&(o.Ub(0,"tr"),o.Ub(1,"td"),o.Ub(2,"strong"),o.Kc(3,"\u5408\u8ba1"),o.Tb(),o.Tb(),o.Ub(4,"td",23),o.Ub(5,"strong"),o.Kc(6),o.fc(7,"_currency"),o.Tb(),o.Tb(),o.Tb(),o.Ic(8,U,8,3,"tr",24)),2&t){const t=o.ec().$implicit,e=o.ec();o.Ab(6),o.Lc(o.gc(7,2,null==e.data?null:e.data.total[t])),o.Ab(2),o.mc("ngIf","income"===t)}}const A=function(){return{show:!1}};function S(t,e){if(1&t&&(o.Sb(0),o.Ub(1,"st",20,21),o.Ic(3,v,9,4,"ng-template",null,22,o.Jc),o.Tb(),o.Rb()),2&t){const t=e.$implicit,a=o.vc(4),n=o.ec();o.Ab(1),o.mc("data",n.data?n.data[t]:null)("loading",n.loading)("columns",n.columns)("page",o.pc(5,A))("body",a)}}const L=[{path:"index",component:(()=>{class t{constructor(t,e,a){this.http=t,this.cdr=e,this.datePipe=a,this.q={},this.date=[],this.loading=!0,this.types=["expense","income"],this.columns=[{title:"\u5206\u7c7b",index:"category_name"},{title:"\u91d1\u989d",type:"number",index:"currency_amount"}],this.tabs=[{key:"day",name:"\u65e5\u89c6\u56fe",show:!0},{key:"month",name:"\u6708\u89c6\u56fe"},{key:"year",name:"\u5e74\u89c6\u56fe"}]}ngOnInit(){this.date=Object(i.m)("month"),this.date&&(this.q.date=this.date.map(t=>this.datePipe.transform(t,"yyyy-MM-dd")).join("~")),this.getData(),this.getRecordSumData()}getData(){this.loading=!0;const t={};Object.entries(this.q).filter(([,t])=>null!==t).map(([e,a])=>t[e]=a),this.q=t,this.http.get("/api/analysis/category",this.q).subscribe(t=>{this.data=Object(i.h)(t.data),this.pieData=Object(i.h)(t.data),this.pieData.expense=this.pieData.expense.map(t=>({x:t.category_name,y:t.currency_amount})),this.pieData.income=this.pieData.income.map(t=>({x:t.category_name,y:t.currency_amount})),this.loading=!1,this.cdr.detectChanges()})}getRecordSumData(){const t={};Object.entries(this.q).filter(([,t])=>null!==t).map(([e,a])=>t[e]=a),this.q=t,this.http.get("/api/analysis/date",this.q).subscribe(t=>{this.recordSumData=t.data,this.recordSumData.expense=this.recordSumData.expense.map(t=>({x:t.date,y:t.currency_amount,color:"#f50"})),this.recordSumData.income=this.recordSumData.income.map(t=>({x:t.date,y:t.currency_amount})),this.cdr.detectChanges()})}reloadData(t){t&&(this.q=t,this.getData(),this.getRecordSumData())}changeTab(t){this.tabs[t].show=!0,this.q.group_type=this.tabs[t].key,this.getRecordSumData(),this.cdr.detectChanges()}handlePieValueFormat(t){return Object(n.c)(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(r.r),o.Ob(o.h),o.Ob(s.f))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-analysis-index"]],viewQuery:function(t,e){var a;1&t&&o.Pc(f,!0),2&t&&o.uc(a=o.cc())&&(e.st=a.first)},decls:13,vars:13,consts:[[1,"pt-lg"],[3,"date","searched","reseted"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","16"],["nzTitle","\u5206\u7c7b\u997c\u56fe",1,"mb-0",3,"nzLoading","nzBordered"],["title","\u603b\u652f\u51fa","subTitle","\u603b\u652f\u51fa","height","295",3,"hasLegend","total","valueFormat","data",4,"ngIf"],["title","\u603b\u6536\u5165","subTitle","\u603b\u6536\u5165","height","295",3,"hasLegend","total","valueFormat","data",4,"ngIf"],[1,"ant-card__body-nopadding","record-sum-card",3,"nzLoading","nzBordered"],[3,"nzSelectedIndexChange",4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","8"],["nzTitle","\u5206\u7c7b\u7edf\u8ba1",1,"mb-0",3,"nzLoading","nzBordered"],[4,"ngFor","ngForOf"],["title","\u603b\u652f\u51fa","subTitle","\u603b\u652f\u51fa","height","295",3,"hasLegend","total","valueFormat","data"],["title","\u603b\u6536\u5165","subTitle","\u603b\u6536\u5165","height","295",3,"hasLegend","total","valueFormat","data"],[3,"nzSelectedIndexChange"],[3,"nzTitle",4,"ngFor","ngForOf"],[3,"nzTitle"],[1,"bar"],["height","295",3,"title","data",4,"ngIf"],["height","295",3,"title","data"],["size","middle",3,"data","loading","columns","page","body"],["st",""],["body",""],[1,"text-right"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Ub(1,"app-record-search",1),o.bc("searched",(function(t){return e.reloadData(t)}))("reseted",(function(t){return e.reloadData(t)})),o.Tb(),o.Tb(),o.Ub(2,"div",2),o.Ub(3,"div",3),o.Ub(4,"nz-card",4),o.Ic(5,y,2,6,"g2-pie",5),o.Ic(6,z,2,6,"g2-pie",6),o.Tb(),o.Ub(7,"nz-card",7),o.Ic(8,I,2,1,"nz-tabset",8),o.Tb(),o.Tb(),o.Ub(9,"div",9),o.Ub(10,"nz-card",10),o.Ic(11,S,5,6,"ng-container",11),o.Tb(),o.Tb(),o.Tb(),o.Pb(12,"div",2)),2&t&&(o.Ab(1),o.mc("date",e.date),o.Ab(1),o.mc("nzGutter",24),o.Ab(2),o.mc("nzLoading",e.loading)("nzBordered",!1),o.Ab(1),o.mc("ngIf",!e.loading),o.Ab(1),o.mc("ngIf",!e.loading),o.Ab(1),o.mc("nzLoading",e.loading)("nzBordered",!1),o.Ab(1),o.mc("ngIf",e.recordSumData),o.Ab(2),o.mc("nzLoading",e.loading)("nzBordered",!1),o.Ab(1),o.mc("ngForOf",e.types),o.Ab(1),o.mc("nzGutter",24))},directives:[d.a,b.c,b.a,l.a,s.n,s.m,m.a,g.b,g.a,u.a,h.a,p.l,p.b],pipes:[r.c],styles:["[_nghost-%COMP%]     .record-sum-card .bar{padding:0 24px 30px}[_nghost-%COMP%]     .record-sum-card .ant-tabs-nav-list{padding-left:24px}"]}),t})()}];let w=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[c.n.forChild(L)],c.n]}),t})(),_=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[n.b,w]]}),t})()}}]);